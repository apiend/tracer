"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function __rest(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&(t[o[r]]=e[o[r]])}return t}var Config={reportUrl:"http://localhost:7002",reportUrlMultiple:"",maxCacheLength:20,isPost:!1,token:"",appVersion:"1.0.0",environment:"prod",outtime:300,enableSPA:!0,autoSendPv:!0,isPage:!0,isAjax:!1,isResource:!1,isError:!0,isRecord:!1,isCountStayTime:!0,isBehavior:!1,ignore:{ignoreErrors:[],ignoreUrls:[],ignorePvs:["404"],ignoreResources:[],ignoreApis:["/api/v1/report/web","livereload.js?snipver=1","/sockjs-node/info"],ignoreBehaviorEles:[]},behavior:{console:["debug","error"],click:!0},maxLength:100,Vue:"",user:{},offlineTime:6e5,sendMill:3e4};function setConfig(e){var n=__assign(__assign({},Config.ignore),e.ignore);Config=__assign(__assign(__assign({},Config),e),{ignore:n})}function getConfig(e){return e&&Config[e]?Config[e]:{}}var noop=function(){};function randomString(){for(var e,n,t=20,o=new Array(t),r=Date.now().toString(36).split("");t-- >0;)n=(e=36*Math.random()|0).toString(36),o[t]=e%3?n:n.toUpperCase();for(var a=0;a<8;a++)o.splice(3*a+2,0,r[a]);return o.join("")}function serialize(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")}function each(e,n){var t=0,o=e.length;if(isTypeOf(e,"Array"))for(;t<o&&!1!==n.call(e[t],e[t],t);t++);else for(var r in e)if(!1===n.call(e[r],e[r],r))break;return e}function isTypeOf(e,n){var t=Object.prototype.toString.call(e).substring(8).replace("]","");return n?t===n:t}var on=function(e,n,t){window.addEventListener?window.addEventListener(e,function o(r){t&&window.removeEventListener(e,o,!0),n.call(this,r)},!0):window.attachEvent&&window.attachEvent("on"+e,function o(r){t&&window.detachEvent("on"+e,o),n.call(this,r)})},off=function(e,n){return n?(window.removeEventListener?window.removeEventListener(e,n):window.detachEvent&&window.detachEvent(e,n),this):this},parseHash=function(e){return(e?parseUrl(e.replace(/^#\/?/,"")):"")||"[index]"},parseUrl=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},fnToString=function(e){return function(){return e+"() { [native code] }"}},warn=function(){var e="object"==typeof console?console.warn:noop;try{var n={warn:e};n.warn.call(n)}catch(e){return noop}return e}(),dispatchCustomEvent=function(e,n){var t;window.CustomEvent?t=new CustomEvent(e,{detail:n}):((t=window.document.createEvent("HTMLEvents")).initEvent(e,!1,!0),t.detail=n),window.dispatchEvent(t)},splitGroup=function(e){var n=e.split("::");return n.length>1?{group:n[0],key:n[1]}:{group:"default_group",key:n[0]}},findIndex=function(e,n){return e.reduce(function(e,t,o){return n(t,o)?o:e},-1)},checkEdge=function(){return navigator.userAgent.indexOf("Edge")>-1},isInIframe=self!=top,replacerFunc=function(){var e=new WeakSet;return function(n,t){if("object"==typeof t&&null!==t){if(e.has(t))return;e.add(t)}return t}},cache=localStorage.getItem("bombay-cache")?JSON.parse(localStorage.getItem("bombay-cache")):[],GlobalVal={lastTime:Date.now(),page:"",sid:"",sBegin:Date.now(),_health:{errcount:0,apisucc:0,apifail:0},circle:!1,reportCache:cache,cssInserted:!1};function setGlobalPage(e){GlobalVal.page=e}function setGlobalSid(){GlobalVal.sid=randomString(),GlobalVal.sBegin=Date.now()}function setGlobalHealth(e,n){"error"===e&&GlobalVal._health.errcount++,"api"===e&&n&&GlobalVal._health.apisucc++,"api"!==e||n||GlobalVal._health.apifail++}function resetGlobalHealth(){GlobalVal._health={errcount:0,apisucc:0,apifail:0}}var version="2.1.0";function getCommonMsg(){var e=getDeviceInfo2(),n=e.deviceModel+"|"+e.deviceOs+"|"+e.wechat,t=navigator.connection;return{t:"",page:getPage(),hash:getHash(),times:1,v:""+version,token:Config.token,e:Config.environment,begin:(new Date).getTime(),uid:getUid(),sid:GlobalVal.sid,sr:screen.width+"x"+screen.height,vp:getScreen(),ct:t?t.effectiveType:"",device:n,ul:getLang(),o:b64EncodeUnicode(encodeURIComponent(location.href)),user:JSON.stringify(Config.user)}}function getHash(){return location.hash}function getPage(){return GlobalVal.page?GlobalVal.page:location.pathname.toLowerCase()}function getUid(){var e=localStorage.getItem("tracer_uid")||"";return e||(e=randomString(),localStorage.setItem("tracer_uid",e)),e}function getLang(){var e=navigator.language||navigator.userLanguage;return e=e.substr(0,2)}function getScreen(){return(document.documentElement.clientWidth||document.body.clientWidth)+"x"+(document.documentElement.clientHeight||document.body.clientHeight)}function getDeviceInfo2(){var e,n=navigator.userAgent,t={},o=n.match(/MicroMessenger.*?(?= )/);return o&&o.length>0&&(t.wechat=o[0]),(n.includes("iPhone")||n.includes("iPad"))&&(n.includes("iPad")?t.deviceModel="iPad":t.deviceModel="iPhone",(o=n.match(/iPhone OS .*?(?= )/))&&o.length>0&&(t.deviceOs=o[0]),e="ios"),n.includes("Android")&&((o=n.match(/Android.*; ?(.*(?= Build))/))&&o.length>1&&(t.deviceModel=o[1]),(o=n.match(/Android.*?(?=;)/))&&o.length>0&&(t.deviceOs=o[0]),e="Android"),e||(t.deviceModel="pc",t.deviceOs="pc",t.wechat="other"),t}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,n){return String.fromCharCode(parseInt(n,16))}))}function report(e){return Array.isArray(e)?send(e):"res"===e.t?send(e):"error"===e.t?send(e):"behavior"===e.t?send(e):"health"===e.t&&window&&window.navigator&&"function"==typeof window.navigator.sendBeacon?sendBeacon(e):send(e),this}function send(e){var n;if(Array.isArray(e))post(Config.reportUrlMultiple,{behaviorList:e});else if(Config.isPost){var t=e[e.t];delete e[e.t],post(Config.reportUrl+"?"+serialize(e),((n={})[e.t]=t,n))}else(new Image).src=Config.reportUrl+"?"+serialize(e)}function post(e,n){var t=window.__oXMLHttpRequest_||window.XMLHttpRequest;if("function"==typeof t)try{var o=new t;o.open("POST",e,!0),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(n))}catch(e){warn("[tracer.js] Failed to log, POST请求失败")}else warn("[tracer.js] Failed to log, 浏览器不支持XMLHttpRequest")}function sendBeacon(e){"object"==typeof e&&(e=serialize(e)),e=Config.reportUrl+"?"+e,window&&window.navigator&&"function"==typeof window.navigator.sendBeacon?window.navigator.sendBeacon(e):warn("[arms] navigator.sendBeacon not surported")}var CIRCLECLS="bombayjs-circle-active",CIRCLESTYLEID="bombayjs-circle-css";function handlePv(){if(Config.autoSendPv){var e=getCommonMsg();if(!Config.ignore.ignorePvs.includes(e.page))report(__assign(__assign({},e),{t:"pv",dt:document.title,dl:encodeURIComponent(location.href),dr:encodeURIComponent(document.referrer),dpr:window.devicePixelRatio,de:document.charset}))}}var normalTarget=function(e){var n,t,o,r,a,i=[];if(!e||!e.tagName)return"";if(i.push(e.tagName.toLowerCase()),e.id&&i.push("#".concat(e.id)),(n=e.className)&&"[object String]"===Object.prototype.toString.call(n))for(t=n.split(/\s+/),a=0;a<t.length;a++)t[a].indexOf("active")<0&&i.push(".".concat(t[a]));var s=["type","name","title","alt"];for(a=0;a<s.length;a++)o=s[a],(r=e.getAttribute(o))&&i.push("[".concat(o,'="').concat(r,'"]'));return i.join("")},getElmPath=function(e){if(!e||1!==e.nodeType)return"";var n=[],t=0,o="";e.innerText&&n.push("("+e.innerText.substr(0,50)+")");for(var r=e||null;r&&t++<5&&"html"!==(o=normalTarget(r));)n.push(o),r=r.parentNode;return n.reverse().join(" > ")};function handleClick(e){if(GlobalVal.circle){var n=e.target.className.split(/\s+/),t=getElmPath(e.target);return t=1===n.length||2===n.length&&""===n[0]?t.replace(/\.\.bombayjs-circle-active/,""):t.replace(/\.bombayjs-circle-active/,""),window.parent.postMessage({t:"setElmPath",path:t,page:GlobalVal.page},"*"),void e.stopPropagation()}var o;try{o=e.target}catch(e){o="<unknown>"}if("INPUT"!==o.nodeName&&"TEXTAREA"!==o.nodeName&&0!==o.length){var r={type:"ui.click",data:{path:getElmPath(o),pageX:e.pageX,pageY:e.pageY,message:""}},a=Config.ignore.ignoreBehaviorEles.some(function(e){return r.data.path.includes(e)});if(!r.data.path||a)return;var i=getCommonMsg(),s=__assign(__assign({},i),{t:"behavior",behavior:r});if(Config.reportUrlMultiple){if(GlobalVal.reportCache.push(s),localStorage.setItem("bombay-cache",JSON.stringify(GlobalVal.reportCache)),GlobalVal.reportCache.length>=Config.maxCacheLength)report(JSON.parse(JSON.stringify(GlobalVal.reportCache))),GlobalVal.reportCache=[],localStorage.removeItem("bombay-cache")}else report(s)}}function handleBlur(e){var n;try{n=e.target}catch(e){n="<unknown>"}if("INPUT"===n.nodeName||"TEXTAREA"===n.nodeName){var t={type:"ui.blur",data:{path:getElmPath(n),pageX:e.pageX,pageY:e.pageY,message:n.value}},o=Config.ignore.ignoreBehaviorEles.some(function(e){return t.data.path.includes(e)});if(t.data.path&&t.data.message&&!o){var r=getCommonMsg();report(__assign(__assign({},r),{t:"behavior",behavior:t}))}}}function handleBehavior(e){var n=getCommonMsg();report(__assign(__assign({},n),{t:"behavior",behavior:e}))}var TIMING_KEYS=["","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","","domInteractive","","domContentLoadedEventEnd","","loadEventStart","","msFirstPaint","secureConnectionStart"];function handlePerf(){var e=window.performance;if(e&&"object"==typeof e)var n={dns:0,tcp:0,ssl:0,ttfb:0,trans:0,dom:0,res:0,firstbyte:0,fpt:0,tti:0,ready:0,load:0},t=e.timing||{},o=Date.now(),r=1,a=setInterval(function(){if(t.loadEventEnd){if(clearInterval(a),"function"==typeof window.PerformanceNavigationTiming){var i=e.getEntriesByType("navigation")[0];i&&(t=i,r=2)}each({dns:[3,2],tcp:[5,4],ssl:[5,17],ttfb:[7,6],trans:[8,7],dom:[10,8],res:[14,12],firstbyte:[7,2],fpt:[8,1],tti:[10,1],ready:[12,1],load:[14,1]},function(e,o){var a=t[TIMING_KEYS[e[1]]],i=t[TIMING_KEYS[e[0]]],s=Math.round(i-a);if(2===r||void 0!==a&&void 0!==i){if("dom"===o)s=Math.round(i-a);s>=0&&s<36e5&&(n[o]=s)}});var s=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection,c=e.navigation||{type:void 0};n.ct=s?s.effectiveType||s.type:"";var l=s&&(s.downlink||s.downlinkMax||s.bandwidth)||null;if((l=l>999?999:l)&&(n.bandwidth=l),n.navtype=1===c.type?"Reload":"Other",1===r&&t[TIMING_KEYS[16]]>0&&t[TIMING_KEYS[1]]>0){var d=t[TIMING_KEYS[16]]-t[TIMING_KEYS[1]];d>=0&&d<36e5&&(n.fpt=d)}1===r&&t[TIMING_KEYS[1]]>0?n.begin=t[TIMING_KEYS[1]]:2===r&&n.load>0?n.begin=o-n.load:n.begin=o;var g=getCommonMsg();report(__assign(__assign(__assign(__assign({},g),{t:"perf"}),n),t))}},50)}function handleHashchange(e){var n=Config.enableSPA?parseHash(location.hash.toLowerCase()):location.pathname.toLowerCase();n&&setPage(n,!1)}function handleHistorystatechange(e){var n=Config.enableSPA?parseHash(e.detail.toLowerCase()):e.detail.toLowerCase();n&&setPage(n,!1)}function setPage(e,n){!n&&GlobalVal.page===e&&GlobalVal.sBegin>Date.now()-100||(!n&&handleHealth(),isInIframe&&window.parent.postMessage({t:"setPage",href:location.href,page:e},"*"),setGlobalPage(e),setGlobalSid(),handlePv())}function handleHealth(){var e=GlobalVal._health.errcount?0:1,n=getCommonMsg(),t=__assign(__assign(__assign({},n),GlobalVal._health),{t:"health",healthy:e,stay:Date.now()-GlobalVal.sBegin});resetGlobalHealth(),report(t)}function handleVueErr(e,n,t){var o=getCommonMsg();report(__assign(__assign({},o),{t:"error",st:"vue_error",msg:b64EncodeUnicode(e),file:"",detail:JSON.stringify(t,replacerFunc())}))}function handleErr(e){if(!Config.ignore.ignoreErrors.includes(e.type)){switch(e.type){case"error":e instanceof ErrorEvent?reportCaughtError(e):reportResourceError(e);break;case"unhandledrejection":reportPromiseError(e)}setGlobalHealth("error")}}function reportCaughtError(e){var n=getCommonMsg(),t=e.name||"CustomError",o=e.message||"",r=e.error.stack||"";report(__assign(__assign({},n),{t:"error",st:"caughterror",cate:t,msg:b64EncodeUnicode(o),detail:b64EncodeUnicode(r),file:b64EncodeUnicode(e.filename)||"",line:e.lineno||"",col:e.colno||""}))}function reportResourceError(e){var n=getCommonMsg(),t=e.target;Config.ignore.ignoreResources.some(function(e){return t.src.includes(e)})||report(__assign(__assign({},n),{t:"error",st:"resource",msg:encodeURIComponent(t.outerHTML),file:b64EncodeUnicode(encodeURIComponent(t.src)),stack:t.localName.toUpperCase()}))}function reportPromiseError(e){var n=getCommonMsg();report(__assign(__assign({},n),{t:"error",st:"promise",msg:b64EncodeUnicode(e.reason)}))}function handleResource(){var e=window.performance;if(!e||"object"!=typeof e||"function"!=typeof e.getEntriesByType)return null;var n=getCommonMsg(),t=__assign(__assign({},n),{dom:0,load:0,t:"res",res:[]}),o=e.timing||{},r=e.getEntriesByType("resource")||[];if("function"==typeof window.PerformanceNavigationTiming){var a=e.getEntriesByType("navigation")[0];a&&(o=a)}if(each({dom:[10,8],load:[14,1]},function(e,n){var r=o[TIMING_KEYS[e[1]]],a=o[TIMING_KEYS[e[0]]];if(void 0!==r&&void 0!==a){var i=Math.round(a-r);i>=0&&i<36e5&&(t[n]=i)}}),r=r.filter(function(e){return!(findIndex(getConfig("ignore").ignoreApis,function(n){return e.name.indexOf(n)>-1})>-1)}),checkEdge()){var i=[];each(r,function(e){i.push({connectEnd:e.connectEnd,connectStart:e.connectStart,domainLookupEnd:e.connectStart,domainLookupStart:e.domainLookupStart,duration:e.duration,entryType:e.entryType,fetchStart:e.fetchStart,initiatorType:e.initiatorType,name:e.name,redirectEnd:e.redirectEnd,redirectStart:e.redirectStart,responseEnd:e.responseEnd,responseStart:e.responseStart,startTime:e.startTime})}),r=i}t.res=r,report(t)}function handleApi(e,n,t,o,r,a){if(e){setGlobalHealth("api",n);var i=b64EncodeUnicode(r),s=encodeURIComponent(e),c=getCommonMsg(),l=__assign(__assign({},c),{t:"api",beigin:a,url:s,success:n,time:t,code:o,msg:i});findIndex(getConfig("ignore").ignoreApis,function(e){return s.indexOf(e)>-1})>-1||report(l)}else warn("[retcode] api is null")}function handleSum(e,n){void 0===n&&(n=1);var t=getCommonMsg(),o=splitGroup(e);report(__assign(__assign(__assign({},t),o),{t:"sum",val:n}))}function handleAvg(e,n){void 0===n&&(n=1);var t=getCommonMsg(),o=splitGroup(e);report(__assign(__assign(__assign({},t),o),{t:"avg",val:n}))}function handleMsg(e){var n=getCommonMsg(),t=splitGroup(e);report(__assign(__assign({},n),{t:"msg",group:t.group,msg:t.key.substr(0,Config.maxLength)}))}function handleHover(e){var n=document.getElementsByClassName(CIRCLECLS);if(n.length>0)for(var t=0;t<n.length;t++)n[t].className=n[t].className.replace(/ bombayjs-circle-active/g,"");e.target.className+=" "+CIRCLECLS}function insertCss(){var e="."+CIRCLECLS+"{border: #ff0000 2px solid;}",n=document.createElement("style");n.type="text/css",n.id=CIRCLESTYLEID;try{n.appendChild(document.createTextNode(e))}catch(t){n.styleSheet.cssText=e}document.getElementsByTagName("head")[0].appendChild(n)}function removeCss(){var e=document.getElementById(CIRCLESTYLEID);e.parentNode.removeChild(e)}function listenCircleListener(){insertCss(),GlobalVal.cssInserted=!0,GlobalVal.circle=!0,on("mouseover",handleHover)}function removeCircleListener(){removeCss(),GlobalVal.cssInserted=!1,GlobalVal.circle=!1,off("mouseover",handleHover)}function listenMessageListener(){on("message",handleMessage)}function handleMessage(e){e.data&&e.data.t&&("setCircle"===e.data.t?Boolean(e.data.v)?listenCircleListener():removeCircleListener():"back"===e.data.t?window.history.back():"forward"===e.data.t&&window.history.forward())}function handleStayTime(){var e=Config.sendMill,n=Date.now()-GlobalVal.lastTime;if(n>Config.offlineTime)GlobalVal.lastTime=Date.now();else if(n>e){GlobalVal.lastTime=Date.now();var t=getCommonMsg();report(__assign(__assign({},t),{t:"duration",duration_ms:n}))}}function handleCustomizeReport(e){if(!e.t)throw Error("行为类型不能为空");var n=getCommonMsg();report(__assign(__assign({},n),e))}function hackConsole(){if(window&&window.console)for(var e=Config.behavior.console,n=0;e.length;n++){var t=e[n],o=window.console[t];if(!window.console[t])return;!function(e,n){window.console[e]=function(){var t=Array.prototype.slice.apply(arguments);handleBehavior({type:"console",data:{level:e,message:JSON.stringify(t,replacerFunc())}}),n&&n.apply(null,t)}}(t,o)}}function hackState(e){var n=history[e];"function"==typeof n&&(history[e]=function(t,o,r){!window.__bb_onpopstate_&&hackOnpopstate();var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),i=location.href,s=n.apply(history,a);if(!r||"string"!=typeof r)return s;if(r===i)return s;try{var c=i.split("#"),l=r.split("#"),d=parseUrl(c[0]),g=parseUrl(l[0]),u=c[1]&&c[1].replace(/^\/?(.*)/,"$1"),p=l[1]&&l[1].replace(/^\/?(.*)/,"$1");d!==g?dispatchCustomEvent("historystatechanged",g):u!==p&&dispatchCustomEvent("historystatechanged",p)}catch(n){warn("[retcode] error in "+e+": "+n)}return s},history[e].toString=fnToString(e))}function hackhook(){hackFetch(),hackAjax()}function hackFetch(){if("function"==typeof window.fetch){var e=window.fetch;window.__oFetch_=e,window.fetch=function(n,t){var o=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),r=Date.now(),a=(n&&"string"!=typeof n?n.url:n)||"",i=parseUrl(a);return i?e.apply(window,o).then(function(e){var n=e.clone(),t=n.headers;if(t&&"function"==typeof t.get){var o=t.get("content-type");if(o&&!/(text)|(json)/.test(o))return e}var a=Date.now()-r;return n.text().then(function(e){n.ok?handleApi(i,!0,a,status,e.substr(0,Config.maxLength)||"",r):handleApi(i,!1,a,status,e.substr(0,Config.maxLength)||"",r)}),e}):e.apply(window,o)}}}function hackAjax(){if("function"==typeof window.XMLHttpRequest){var e=0,n="",t=window.XMLHttpRequest;window.__oXMLHttpRequest_=t,window.XMLHttpRequest=function(o){var r=new t(o);if(!r.addEventListener)return r;var a=r.open,i=r.send;return r.open=function(e,t){var o=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);n=parseUrl(t=t),a.apply(r,o)},r.send=function(){e=Date.now();var n=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);i.apply(r,n)},r.onreadystatechange=function(){if(n&&4===r.readyState){var t=Date.now()-e;if(r.status>=200&&r.status<=299){var o=r.status||200;if("function"==typeof r.getResponseHeader){var a=r.getResponseHeader("Content-Type");if(a&&!/(text)|(json)/.test(a))return}handleApi(n,!0,t,o,r.responseText.substr(0,Config.maxLength)||"",e)}else handleApi(n,!1,t,o||"FAILED",r.responseText.substr(0,Config.maxLength)||"",e)}},r}}}function hackOnpopstate(){window.__bb_onpopstate_=window.onpopstate,window.addEventListener("popstate",function(){setPage(Config.enableSPA?parseHash(location.hash.toLowerCase()):location.pathname.toLowerCase(),!1)})}var Tracer=function(){function e(e,n){this.init(e)}return e.prototype.init=function(e){var n=e.Vue,t=__rest(e,["Vue"]);if(t&&!t.token)throw Error("请输入一个token");n&&this.addListenVueError(n),setConfig(t),setPage(Config.enableSPA?parseHash(location.hash.toLowerCase()):location.pathname.toLowerCase(),!0),Config.isPage&&this.sendPerf(),Config.enableSPA&&this.addListenRouterChange(),Config.isError&&this.addListenJs(),Config.isAjax&&this.addListenAjax(),Config.isRecord&&this.addRrweb(),Config.isBehavior&&this.addListenBehavior(),Config.isResource&&this.sendResource(),window.__bb=this,this.addListenUnload(),listenMessageListener(),GlobalVal.circle&&listenCircleListener()},e.prototype.handleCustomizeReport=function(e){if(!Config.token)throw Error("请输入一个合法token");handleCustomizeReport(e)},e.prototype.setUserInfo=function(e){setConfig({user:e})},e.prototype.sendPerf=function(){handlePerf()},e.prototype.sendResource=function(){"complete"===window.document.readyState?handleResource():this.addListenResource()},e.prototype.addListenResource=function(){on("load",handleResource)},e.prototype.addListenBehavior=function(){hackConsole(),Config.behavior.click&&this.addListenClick()},e.prototype.addListenClick=function(){on("click",handleClick),on("blur",handleBlur),Config.isCountStayTime&&(on("click",handleStayTime),on("blur",handleStayTime))},e.prototype.addListenRouterChange=function(){hackState("pushState"),hackState("replaceState"),on("hashchange",handleHashchange),on("historystatechanged",handleHistorystatechange)},e.prototype.addListenVueError=function(e){if(e&&e.config){e.config.errorHandler;e.config.errorHandler=function(e,n,t){console.error(e),handleVueErr(e,n,t)}}},e.prototype.addListenJs=function(){on("error",handleErr),on("unhandledrejection",handleErr)},e.prototype.addListenAjax=function(){hackhook()},e.prototype.addListenUnload=function(){on("beforeunload",handleHealth),this.destroy()},e.prototype.addRrweb=function(){},e.prototype.removeListenRouterChange=function(){off("hashchange",handleHashchange),off("historystatechanged",handleHistorystatechange)},e.prototype.removeListenJs=function(){off("error",handleErr),off("unhandledrejection",handleErr)},e.prototype.removeListenResource=function(){off("beforeunload",handleHealth)},e.prototype.removeListenAjax=function(){},e.prototype.removeListenUnload=function(){off("load",handleResource)},e.prototype.removeRrweb=function(){},e.prototype.sum=function(e,n){handleSum(e,n)},e.prototype.avg=function(e,n){handleAvg(e,n)},e.prototype.msg=function(e){handleMsg(e)},e.prototype.api=function(e,n,t,o,r){handleApi(e,n,t,o,r,Date.now())},e.prototype.destroy=function(){Config.enableSPA&&this.removeListenRouterChange(),Config.isError&&this.removeListenJs(),Config.isAjax&&this.removeListenAjax(),Config.isRecord&&this.removeRrweb(),Config.isResource&&this.removeListenResource(),this.removeListenResource()},e}();module.exports=Tracer;
